-------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\opensafely-ics-research\analysis\copd_log\07_an_models_interact_copd.log
  log type:  text
 opened on:  27 May 2020, 10:31:09

. 
. * Open Stata dataset
. use $tempdir\analysis_dataset_STSET_$outcome, clear

. 
. /* Age Interaction============================================================*/ 
. 
. /* The smallest age group in COPD is much smaller than for asthma (35-40). 
>    To be able to fit a meaningful model, combining this with the category above, 
>    to create a category 35 - 50 */ 
. /* So few deaths occuring below 50 years this cannot be used as a category, 
>    so updating to 35-60 */ 
.    
. recode agegroup(1 = 2)
(agegroup: 1232 changes made)

. recode agegroup(2 = 3)
(agegroup: 11257 changes made)

. tab agegroup, nolabel 

Grouped age |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     52,165       17.88       17.88
          4 |     80,784       27.68       45.56
          5 |    104,338       35.75       81.31
          6 |     54,538       18.69      100.00
------------+-----------------------------------
      Total |    291,825      100.00

. 
. label define agegroup2  3 "35-<60" ///
>                                                 4 "60-<70" ///
>                                                 5 "70-<80" ///
>                                                 6 "80+"

.                                                 
. label values agegroup agegroup2

. tab agegroup 

Grouped age |      Freq.     Percent        Cum.
------------+-----------------------------------
     35-<60 |     52,165       17.88       17.88
     60-<70 |     80,784       27.68       45.56
     70-<80 |    104,338       35.75       81.31
        80+ |     54,538       18.69      100.00
------------+-----------------------------------
      Total |    291,825      100.00

. 
. /* Check Counts */ 
. 
. bysort agegroup: tab exposure $outcome, row

-------------------------------------------------------------------------------------------------------------
-> agegroup = 35-<60

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |   Failure/censoring
                      |     indicator for
                      |  outcome: ONS covid
       COPD Treatment |         death
             Exposure |         0          1 |     Total
----------------------+----------------------+----------
REDACTED
----------------------+----------------------+----------
                Total |    21,595          9 |    21,604 
                      |     99.96       0.04 |    100.00 

-------------------------------------------------------------------------------------------------------------
-> agegroup = 60-<70

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |   Failure/censoring
                      |     indicator for
                      |  outcome: ONS covid
       COPD Treatment |         death
             Exposure |         0          1 |     Total
----------------------+----------------------+----------
LABA/LAMA Combination |    12,588          7 |    12,595 
                      |     99.94       0.06 |    100.00 
----------------------+----------------------+----------
      ICS Combination |    29,504         19 |    29,523 
                      |     99.94       0.06 |    100.00 
----------------------+----------------------+----------
                Total |    42,092         26 |    42,118 
                      |     99.94       0.06 |    100.00 

-------------------------------------------------------------------------------------------------------------
-> agegroup = 70-<80

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |   Failure/censoring
                      |     indicator for
                      |  outcome: ONS covid
       COPD Treatment |         death
             Exposure |         0          1 |     Total
----------------------+----------------------+----------
LABA/LAMA Combination |    16,068         28 |    16,096 
                      |     99.83       0.17 |    100.00 
----------------------+----------------------+----------
      ICS Combination |    40,259        119 |    40,378 
                      |     99.71       0.29 |    100.00 
----------------------+----------------------+----------
                Total |    56,327        147 |    56,474 
                      |     99.74       0.26 |    100.00 

-------------------------------------------------------------------------------------------------------------
-> agegroup = 80+

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

                      |   Failure/censoring
                      |     indicator for
                      |  outcome: ONS covid
       COPD Treatment |         death
             Exposure |         0          1 |     Total
----------------------+----------------------+----------
LABA/LAMA Combination |     7,644         50 |     7,694 
                      |     99.35       0.65 |    100.00 
----------------------+----------------------+----------
      ICS Combination |    20,448        169 |    20,617 
                      |     99.18       0.82 |    100.00 
----------------------+----------------------+----------
                Total |    28,092        219 |    28,311 
                      |     99.23       0.77 |    100.00 


. 
. /* Univariable model */ 
. 
. stcox i.exposure i.agegroup

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -4772.5589
Iteration 1:   log likelihood = -4625.8092
Iteration 2:   log likelihood = -4598.3855
Iteration 3:   log likelihood = -4596.6307
Iteration 4:   log likelihood =   -4596.63
Refining estimates:
Iteration 0:   log likelihood =   -4596.63

Cox regression -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(4)       =      351.86
Log likelihood  =     -4596.63                  Prob > chi2      =      0.0000

----------------------------------------------------------------------------------
              _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
        exposure |
ICS Combination  |   1.404414   .1701897     2.80   0.005     1.107503    1.780924
                 |
        agegroup |
         60-<70  |   1.474535   .5702789     1.00   0.315     .6909575    3.146725
         70-<80  |   6.212359   2.133346     5.32   0.000      3.16921    12.17761
            80+  |   18.55502   6.311442     8.59   0.000     9.526367     36.1406
----------------------------------------------------------------------------------

. estimates store A

. 
. stcox i.exposure##i.agegroup

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -4772.5589
Iteration 1:   log likelihood =  -4629.226
Iteration 2:   log likelihood = -4597.7654
Iteration 3:   log likelihood =  -4595.896
Iteration 4:   log likelihood = -4595.8946
Refining estimates:
Iteration 0:   log likelihood = -4595.8946

Cox regression -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(7)       =      353.33
Log likelihood  =   -4595.8946                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
               exposure |
       ICS Combination  |   1.639913   1.314856     0.62   0.537     .3406759    7.894061
                        |
               agegroup |
                60-<70  |   1.917024   1.537039     0.81   0.417     .3982429    9.227991
                70-<80  |   6.015601   4.402969     2.45   0.014     1.433056    25.25194
                   80+  |   22.63764   16.32424     4.33   0.000     5.508344    93.03394
                        |
      exposure#agegroup |
ICS Combination#60-<70  |   .7066332   .6470021    -0.38   0.705      .117442     4.25172
ICS Combination#70-<80  |   1.035203   .8580174     0.04   0.967     .2039465    5.254545
   ICS Combination#80+  |   .7725425   .6317746    -0.32   0.752     .1555326    3.837278
-----------------------------------------------------------------------------------------

. estimates store B

. estimates save ./$tempdir/univar_int, replace 
file ./copd_tempdata/univar_int.ster saved

. 
. lrtest A B

Likelihood-ratio test                                 LR chi2(3)  =      1.47
(Assumption: A nested in B)                           Prob > chi2 =    0.6890

. local univar_p = round(r(p),0.001)

. 
. /* Multivariable models */ 
. 
. * Age and Gender 
. 
. stcox i.exposure i.agegroup i.male

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -4772.5589
Iteration 1:   log likelihood = -4609.6567
Iteration 2:   log likelihood =  -4582.221
Iteration 3:   log likelihood = -4580.4722
Iteration 4:   log likelihood = -4580.4715
Refining estimates:
Iteration 0:   log likelihood = -4580.4715

Cox regression -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(5)       =      384.17
Log likelihood  =   -4580.4715                  Prob > chi2      =      0.0000

----------------------------------------------------------------------------------
              _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
        exposure |
ICS Combination  |   1.408014   .1706284     2.82   0.005     1.110338    1.785495
                 |
        agegroup |
         60-<70  |   1.463786   .5661263     0.99   0.325     .6859167    3.123805
         70-<80  |   6.104289   2.096338     5.27   0.000     3.113974    11.96617
            80+  |   18.13433    6.16882     8.52   0.000     9.309909    35.32302
                 |
          1.male |   1.811627   .1953426     5.51   0.000     1.466513    2.237955
----------------------------------------------------------------------------------

. estimates store A

. 
. stcox i.exposure##i.agegroup i.male

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -4772.5589
Iteration 1:   log likelihood = -4613.1346
Iteration 2:   log likelihood = -4581.6296
Iteration 3:   log likelihood = -4579.7621
Iteration 4:   log likelihood = -4579.7608
Refining estimates:
Iteration 0:   log likelihood = -4579.7608

Cox regression -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(8)       =      385.60
Log likelihood  =   -4579.7608                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
               exposure |
       ICS Combination  |   1.667277   1.336804     0.64   0.524     .3463571    8.025859
                        |
               agegroup |
                60-<70  |   1.914333   1.534881     0.81   0.418     .3976839    9.215038
                70-<80  |   5.991616   4.385416     2.45   0.014     1.427342    25.15127
                   80+  |   22.33425   16.10554     4.31   0.000     5.434482    91.78771
                        |
      exposure#agegroup |
ICS Combination#60-<70  |   .7009797   .6418264    -0.39   0.698     .1165022    4.217712
ICS Combination#70-<80  |   1.016806   .8427744     0.02   0.984     .2003198    5.161217
   ICS Combination#80+  |   .7628212   .6238269    -0.33   0.741     .1535746    3.789013
                        |
                 1.male |   1.810841   .1952608     5.51   0.000     1.465873    2.236992
-----------------------------------------------------------------------------------------

. estimates store B

. estimates save ./$tempdir/multivar1_int, replace 
file ./copd_tempdata/multivar1_int.ster saved

. 
. lrtest A B

Likelihood-ratio test                                 LR chi2(3)  =      1.42
(Assumption: A nested in B)                           Prob > chi2 =    0.7005

. local multivar1_p = round(r(p),0.001)

. 
. * Age, Gender and Comorbidities 
. stcox i.exposure i.agegroup i.male      i.obese4cat                                     ///
>                                                                                 i.smoke_nomiss             
>              ///
>                                                                                 i.asthma_ever              
>              ///
>                                                                                 i.imd                      
>                      ///
>                                                                                 i.ckd                      
>                      ///             
>                                                                                 i.hypertension             
>              ///             
>                                                                                 i.heart_failure            
>              ///             
>                                                                                 i.other_heart_disease      
>      ///             
>                                                                                 i.diabcat                  
>                      ///             
>                                                                                 i.cancer_ever              
>              ///                                                     
>                                                                                 i.statin                   
>                      ///             
>                                                                                 i.flu_vaccine              
>              ///     
>                                                                                 i.pneumococcal_vaccine     
>      ///     
>                                                                                 i.exacerbations, strata(stp
> )                                    

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -3515.1894
Iteration 1:   log likelihood = -3312.9142
Iteration 2:   log likelihood = -3246.5171
Iteration 3:   log likelihood = -3243.8035
Iteration 4:   log likelihood =  -3243.802
Refining estimates:
Iteration 0:   log likelihood =  -3243.802

Stratified Cox regr. -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(26)      =      542.77
Log likelihood  =    -3243.802                  Prob > chi2      =      0.0000

---------------------------------------------------------------------------------------------
                         _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                   exposure |
           ICS Combination  |   1.358841   .1688429     2.47   0.014      1.06513    1.733544
                            |
                   agegroup |
                    60-<70  |   1.250896   .4869792     0.58   0.565      .583237    2.682858
                    70-<80  |   4.259507   1.504413     4.10   0.000      2.13169    8.511276
                       80+  |   9.827906   3.522919     6.38   0.000     4.867866     19.8419
                            |
                     1.male |   1.770766   .1952274     5.18   0.000     1.426645    2.197892
                            |
                  obese4cat |
         Obese I (30-34.9)  |   1.098103   .1387406     0.74   0.459       .85723    1.406658
        Obese II (35-39.9)  |   1.208353   .2211507     1.03   0.301     .8441279    1.729734
           Obese III (40+)  |   1.594532   .3914219     1.90   0.057     .9855579    2.579788
                            |
               smoke_nomiss |
                   Current  |   .5073904   .0810619    -4.25   0.000     .3709815    .6939564
              1.asthma_ever |   .8265314   .1004968    -1.57   0.117     .6512728    1.048952
                            |
                        imd |
                         2  |   1.048729    .161161     0.31   0.757     .7759913    1.417326
                         3  |   .8189079   .1369538    -1.19   0.232     .5900386    1.136553
                         4  |   1.203052   .1924611     1.16   0.248      .879248    1.646105
           5 most deprived  |   1.520455   .2478135     2.57   0.010     1.104687    2.092704
                            |
                        ckd |
                       CKD  |   1.907536    .211499     5.82   0.000     1.534954    2.370555
             1.hypertension |   .9528554   .1059396    -0.43   0.664     .7662834    1.184853
            1.heart_failure |   1.718452   .2132188     4.36   0.000     1.347484    2.191549
      1.other_heart_disease |   1.046993   .1204961     0.40   0.690     .8355663    1.311918
                            |
                    diabcat |
       Controlled diabetes  |   1.348319    .162786     2.48   0.013     1.064204    1.708285
     Uncontrolled diabetes  |   1.592197   .2750104     2.69   0.007     1.134943    2.233673
Diabetes, no hba1c measure  |      1.736   1.239706     0.77   0.440      .428245    7.037314
                            |
              1.cancer_ever |   1.067785   .1332722     0.53   0.599     .8360722    1.363716
                   1.statin |   .8121338   .0891558    -1.90   0.058      .654912    1.007099
              1.flu_vaccine |   1.044272   .1392748     0.32   0.745     .8040604    1.356246
     1.pneumococcal_vaccine |   .8914908   .1468679    -0.70   0.486     .6454853    1.231253
            1.exacerbations |   1.461286   .1569392     3.53   0.000     1.183908    1.803651
---------------------------------------------------------------------------------------------
                                                             Stratified by stp

.                                                                                 
. estimates store A

. 
. stcox i.exposure##i.agegroup i.male     i.obese4cat                                     ///
>                                                                                 i.smoke_nomiss             
>              ///
>                                                                                 i.asthma_ever              
>              ///
>                                                                                 i.imd                      
>                      ///
>                                                                                 i.ckd                      
>                      ///             
>                                                                                 i.hypertension             
>              ///             
>                                                                                 i.heart_failure            
>              ///             
>                                                                                 i.other_heart_disease      
>      ///             
>                                                                                 i.diabcat                  
>                      ///             
>                                                                                 i.cancer_ever              
>              ///                                                     
>                                                                                 i.statin                   
>                      ///                     
>                                                                                 i.flu_vaccine              
>              ///     
>                                                                                 i.pneumococcal_vaccine     
>      ///     
>                                                                                 i.exacerbations, strata(stp
> )                    

         failure _d:  onscoviddeath
   analysis time _t:  (stime_onscoviddeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -3515.1894
Iteration 1:   log likelihood = -3315.3347
Iteration 2:   log likelihood = -3245.9783
Iteration 3:   log likelihood = -3243.1448
Iteration 4:   log likelihood = -3243.1421
Iteration 5:   log likelihood = -3243.1421
Refining estimates:
Iteration 0:   log likelihood = -3243.1421

Stratified Cox regr. -- Breslow method for ties

No. of subjects =      148,507                  Number of obs    =     148,507
No. of failures =          401
Time at risk    =      9161390
                                                LR chi2(29)      =      544.09
Log likelihood  =   -3243.1421                  Prob > chi2      =      0.0000

---------------------------------------------------------------------------------------------
                         _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                   exposure |
           ICS Combination  |   1.535139   1.231845     0.53   0.593      .318505    7.399108
                            |
                   agegroup |
                    60-<70  |    1.64994   1.325217     0.62   0.533     .3418148    7.964262
                    70-<80  |   4.067983   2.998864     1.90   0.057     .9591457    17.25336
                       80+  |   11.54163   8.437222     3.35   0.001     2.754341     48.3634
                            |
          exposure#agegroup |
    ICS Combination#60-<70  |   .6942522   .6357157    -0.40   0.690      .115368    4.177814
    ICS Combination#70-<80  |   1.055408   .8748845     0.07   0.948     .2078804    5.358301
       ICS Combination#80+  |   .8123771   .6644932    -0.25   0.799     .1634961    4.036527
                            |
                     1.male |   1.769489     .19508     5.18   0.000     1.425627    2.196291
                            |
                  obese4cat |
         Obese I (30-34.9)  |   1.097556   .1386645     0.74   0.461     .8568134     1.40594
        Obese II (35-39.9)  |   1.209374   .2213324     1.04   0.299     .8448485    1.731181
           Obese III (40+)  |   1.591582   .3907069     1.89   0.058     .9837237    2.575045
                            |
               smoke_nomiss |
                   Current  |    .507902   .0811429    -4.24   0.000     .3713567    .6946542
              1.asthma_ever |   .8268963   .1005349    -1.56   0.118       .65157      1.0494
                            |
                        imd |
                         2  |   1.049627    .161307     0.32   0.753     .7766441    1.418561
                         3  |   .8189928   .1369694    -1.19   0.232     .5900978    1.136674
                         4  |   1.202622   .1924179     1.15   0.249     .8788968    1.645584
           5 most deprived  |   1.521323   .2479851     2.57   0.010     1.105274     2.09398
                            |
                        ckd |
                       CKD  |   1.907302   .2115333     5.82   0.000      1.53467    2.370411
             1.hypertension |   .9526243   .1059036    -0.44   0.662     .7661138    1.184541
            1.heart_failure |   1.717678   .2130909     4.36   0.000     1.346926    2.190482
      1.other_heart_disease |   1.047952   .1205957     0.41   0.684     .8363489    1.313094
                            |
                    diabcat |
       Controlled diabetes  |   1.349184   .1628911     2.48   0.013     1.064886    1.709383
     Uncontrolled diabetes  |   1.595893   .2756494     2.71   0.007     1.137576     2.23886
Diabetes, no hba1c measure  |   1.734437   1.238533     0.77   0.441     .4278875    7.030519
                            |
              1.cancer_ever |   1.068476   .1333617     0.53   0.596     .8366086    1.364607
                   1.statin |   .8114738   .0890814    -1.90   0.057     .6543828    1.006276
              1.flu_vaccine |   1.044312   .1392888     0.33   0.745     .8040781     1.35632
     1.pneumococcal_vaccine |   .8919647   .1470364    -0.69   0.488     .6457002    1.232152
            1.exacerbations |   1.460843   .1568684     3.53   0.000     1.183586    1.803049
---------------------------------------------------------------------------------------------
                                                             Stratified by stp

. estimates store B

. estimates save ./$tempdir/multivar2_int, replace 
file ./copd_tempdata/multivar2_int.ster saved

. 
. lrtest A B

Likelihood-ratio test                                 LR chi2(3)  =      1.32
(Assumption: A nested in B)                           Prob > chi2 =    0.7244

. local multivar2_p = round(r(p),0.001)

. 
. /* Print interaction table====================================================*/ 
. cap file close tablecontent

. file open tablecontent using ./$outdir/table3.txt, write text replace

. 
. * Column headings 
. file write tablecontent ("Table 3: Current ICS use and ONS COVID-19 death, Age Interaction - $population Po
> pulation") _n

. file write tablecontent _tab ("N") _tab ("Univariable") _tab _tab _tab ("Age/Sex Adjusted") _tab _tab _tab 
>  ///
>                                                 ("Age/Sex and Comorbidity Adjusted") _tab _tab _tab _n

. file write tablecontent _tab _tab ("HR") _tab ("95% CI") _tab ("p (interaction)") _tab ("HR") _tab ///
>                                                 ("95% CI") _tab ("p (interaction)") _tab ("HR") _tab ("95% 
> CI") _tab ("p (interaction)") _tab _n

. 
. * Overall p-values 
. file write tablecontent ("Agegroup") _tab _tab _tab _tab ("`univar_p'") ///
>                                                 _tab _tab _tab ("`multivar1_p'") /// 
>                                                 _tab _tab _tab ("`multivar2_p'") _n

. 
.                                                 
. * Generic program to print model for a level of another variable 
. cap prog drop printinteraction

. prog define printinteraction 
  1. syntax, variable(varname) min(real) max(real) 
  2. 
.         forvalues varlevel = `min'/`max'{ 
  3. 
.                 * Row headings 
.                 file write tablecontent ("`varlevel'") _n       
  4. 
.                 local lab0: label exposure 0
  5.                 local lab1: label exposure 1
  6.                  
.                 /* Counts */
.                         
.                 * First row, exposure = 0 (reference)
.                 
.         file write tablecontent ("`lab0'") _tab
  7. 
.                         cou if exposure == 0 & `variable' == `varlevel'
  8.                         local rowdenom = r(N)
  9.                         cou if exposure == 0  & `variable' == `varlevel' & cpnsdeath == 1
 10.                         local pct = 100*(r(N)/`rowdenom')
 11.                         
.                         
.                 file write tablecontent (r(N)) (" (") %3.1f (`pct') (")") _tab
 12.                 file write tablecontent ("1.00 (ref)") _tab _tab ("1.00 (ref)") _tab _tab ("1.00 (ref)")
>  _n
 13.                         
.                 * Second row, exposure = 1 (comparator)
. 
.                 file write tablecontent ("`lab1'") _tab  
 14. 
.                         cou if exposure == 1 & `variable' == `varlevel'
 15.                         local rowdenom = r(N)
 16.                         cou if exposure == 1 & `variable' == `varlevel' & cpnsdeath == 1
 17.                         local pct = 100*(r(N)/`rowdenom')
 18.                         
.                 file write tablecontent (r(N)) (" (") %3.1f (`pct') (")") _tab
 19. 
.                 * Print models 
.                 estimates use ./$tempdir/univar_int 
 20.                 qui lincom 1.exposure + 1.exposure#`varlevel'.`variable', eform
 21.                 file write tablecontent %4.2f (r(estimate)) _tab %4.2f (r(lb)) (" - ") %4.2f (r(ub)) _ta
> b _tab
 22. 
.                 estimates use ./$tempdir/multivar1_int
 23.                 qui lincom 1.exposure + 1.exposure#`varlevel'.`variable', eform
 24.                 file write tablecontent %4.2f (r(estimate)) _tab %4.2f (r(lb)) (" - ") %4.2f (r(ub)) _ta
> b _tab
 25. 
.                 estimates use ./$tempdir/multivar2_int
 26.                 qui lincom 1.exposure + 1.exposure#`varlevel'.`variable', eform
 27.                 file write tablecontent %4.2f (r(estimate)) _tab %4.2f (r(lb)) (" - ") %4.2f (r(ub)) _ta
> b _n 
 28.         
.         } 
 29.                 
. end

. 
. printinteraction, variable(agegroup) min(3) max(6) 
  6,891
  1
  14,713
  7
  12,595
  6
  29,523
  16
  16,096
  20
  40,378
  86
  7,694
  25
  20,617
  100

. 
. file write tablecontent _n

. file close tablecontent

. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\analyses\opensafely-ics-research\analysis\copd_log\07_an_models_interact_copd.log
  log type:  text
 closed on:  27 May 2020, 10:32:00
-------------------------------------------------------------------------------------------------------------
